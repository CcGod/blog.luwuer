---
title: JS定义常量对象
tags: [ES6, const]
date: 2017-09-19 17:40:50
---

ES6中新增const关键字，用于**声明创建**一个值得只读引用。

但其只是规定变量的标识符不能重新分配，例如声明变量是引用类型，则不可变的只是变量绑定的指针（JS不存在这个概念，指变量的值是栈中存放的内存地址，访问时会自动寻址找到堆中存放的对象），而对象的属性可以任意改变。
```javascript
const o = {
  a: 1
}
const a = [2, 3, 4]

o.b = 2    // 可扩展
o.c = 4
delete o.c // 可删除
o.a = 3    // 可修改

a.push(5) // 可扩展
a.pop()   // 可删除
a[0] = 3  // 可修改

console.log(o) // {a: 3, b: 2}
console.log(a) // [3, 3, 5]
```

所以const关键字并不能定义真正的常量对象，真正的常量对象应该是：不可扩展、不可删除、不可修改的。

要做到这些，我们需要一个函数的帮助。

### 实现常量对象

`Object.freeze`方法可以冻结一个对象，冻结表示该对象不可扩展、不可删除、不可修改，并且不能修改该对象已有属性的可枚举性、可配置性、可写性。该方法修改原对象，并返回该对象。（0 0 0）
> `Object.isFrozen(obj)`返回obj是否被冻结。

```javascript
const o = { a:1 }
Object.freeze(o)
```


### 相关函数

- `Object.preventExtensions`方法让一个对象变的不可扩展，也就是永远不能再添加新的属性。（0 1 1）
  > `Object.isExtensible(obj)`返回obj是否可扩展。
- `Object.seal`方法让一个对象变的不可扩展且不可删除（封闭），也就是永远不能再添加新的属性、删除已由属性。（0 0 1）
  > `Object.isSealed(obj)`返回obj是否被封闭。